/*!
 * History API JavaScript Library v4.1.8
 *
 * Support: IE6+, FF3+, Opera 9+, Safari, Chrome and other
 *
 * Copyright 2011-2014, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 2014-06-05 11:54
 */
(function(N){"function"===typeof define&&define.amd?define("object"!==typeof document||"loading"!==document.readyState?[]:"html5-history-api",N):N()})(function(){var j=!0,l=null,m=!1;function O(a,b){var c=d.history!==n;c&&(d.history=n);a.apply(n,b);c&&(d.history=k)}function I(){}function h(a,b,c){if(a!=l&&""!==a&&!b){var b=h(),e=g.getElementsByTagName("base")[0];!c&&(e&&e.getAttribute("href"))&&(e.href=e.href,b=h(e.href,l,j));c=b.e;e=b.h;a=""+a;a=/^(?:[\w0-9]+\:)?\/\//.test(a)?0===a.indexOf("/")?e+a:a:e+"//"+b.g+(0===a.indexOf("/")?a:0===a.indexOf("?")?c+a:0===a.indexOf("#")?c+b.f+a:c.replace(/[^\/]+$/g,"")+a)}else if(a=b?a:f.href,!q||c)a=a.replace(/^[^#]*/,"")||
"#",a=f.protocol.replace(/:.*$|$/,":")+"//"+f.host+i.basepath+a.replace(RegExp("^#[/]?(?:"+i.type+")?"),"");P.href=a;var a=/(?:([\w0-9]+:))?(?:\/\/(?:[^@]*@)?([^\/:\?#]+)(?::([0-9]+))?)?([^\?#]*)(?:(\?[^#]+)|\?)?(?:(#.*))?/.exec(P.href),b=a[2]+(a[3]?":"+a[3]:""),c=a[4]||"/",e=a[5]||"",d="#"===a[6]?"":a[6]||"",o=c+e+d,u=c.replace(RegExp("^"+i.basepath,"i"),i.type)+e;return{a:a[1]+"//"+b+o,h:a[1],g:b,i:a[2],k:a[3]||"",e:c,f:e,b:d,c:o,j:u,d:u+d}}function Z(){var a;try{a=d.sessionStorage,a.setItem(D+
"t","1"),a.removeItem(D+"t")}catch(b){a={getItem:function(a){a=g.cookie.split(a+"=");return 1<a.length&&a.pop().split(";").shift()||"null"},setItem:function(a){var b={};if(b[f.href]=k.state)g.cookie=a+"="+r.stringify(b)}}}try{p=r.parse(a.getItem(D))||{}}catch(c){p={}}v(w+"unload",function(){a.setItem(D,r.stringify(p))},m)}function x(a,b,c,e){var c=c||{set:I},f=!c.set,g=!c.get,u={configurable:j,set:function(){f=1},get:function(){g=1}};try{B(a,b,u),a[b]=a[b],B(a,b,c)}catch(ha){}if(!f||!g)if(a.__defineGetter__&&
(a.__defineGetter__(b,u.get),a.__defineSetter__(b,u.set),a[b]=a[b],c.get&&a.__defineGetter__(b,c.get),c.set&&a.__defineSetter__(b,c.set)),(!f||!g)&&a===d){try{var $=a[b];a[b]=l}catch(ia){}if("execScript"in d)d.execScript("Public "+b,"VBScript"),d.execScript("var "+b+";","JavaScript");else try{B(a,b,{value:I})}catch(k){}a[b]=$}else if(!f||!g)try{try{var h=E.create(a);B(E.getPrototypeOf(h)===a?h:a,b,c);for(var i in a)"function"===typeof a[i]&&(h[i]=a[i].bind(a));try{e.call(h,h,a)}catch(n){}a=h}catch(p){B(a.constructor.prototype,
b,c)}}catch(q){return m}return a}function aa(a,b,c){c=c||{};a=a===J?f:a;c.set=c.set||function(c){a[b]=c};c.get=c.get||function(){return a[b]};return c}function ba(a,b,c){a in y?y[a].push(b):3<arguments.length?v(a,b,c,arguments[3]):v(a,b,c)}function ca(a,b,c){var d=y[a];if(d)for(a=d.length;--a;){if(d[a]===b){d.splice(a,1);break}}else Q(a,b,c)}function F(a,b){var c=(""+("string"===typeof a?a:a.type)).replace(/^on/,""),e=y[c];if(e){b="string"===typeof a?b:a;if(b.target==l)for(var f=["target","currentTarget",
"srcElement","type"];a=f.pop();)b=x(b,a,{get:"type"===a?function(){return c}:function(){return d}});(("popstate"===c?d.onpopstate:d.onhashchange)||I).call(d,b);for(var f=0,g=e.length;f<g;f++)e[f].call(d,b);return j}return da(a,b)}function R(){var a=g.createEvent?g.createEvent("Event"):g.createEventObject();a.initEvent?a.initEvent("popstate",m,m):a.type="popstate";a.state=k.state;F(a)}function s(a,b,c,d){q||(b=h(b),b.c!==h().c&&(z=d,c?f.replace("#"+b.d):f.hash=b.d));!G&&a&&(p[f.href]=a);C=m}function K(a){var b=
z;z=f.href;if(b){S!==f.href&&R();var a=a||d.event,b=h(z,j),c=h();a.oldURL||(a.oldURL=b.a,a.newURL=c.a);b.b!==c.b&&F(a)}}function T(a){setTimeout(function(){v("popstate",function(a){S=f.href;G||(a=x(a,"state",{get:function(){return k.state}}));F(a)},m)},0);!q&&(a!==j&&k.location)&&(U(k.location.hash),C&&(C=m,R()))}function ea(a){var a=a||d.event,b;a:{for(b=a.target||a.srcElement;b;){if("A"===b.nodeName)break a;b=b.parentNode}b=void 0}var c="defaultPrevented"in a?a.defaultPrevented:a.returnValue===
m;b&&("A"===b.nodeName&&!c)&&(c=h(),b=h(b.getAttribute("href",2)),c.a.split("#").shift()===b.a.split("#").shift()&&b.b&&(c.b!==b.b&&(k.location.hash=b.b),U(b.b),a.preventDefault?a.preventDefault():a.returnValue=m))}function U(a){var b=g.getElementById(a=(a||"").replace(/^#/,""));b&&(b.id===a&&"A"===b.nodeName)&&(a=b.getBoundingClientRect(),d.scrollTo(H.scrollLeft||0,a.top+(H.scrollTop||0)-(H.clientTop||0)))}function fa(){function a(a){var b=[],e="VBHistoryClass"+(new Date).getTime()+c++,f=["Class "+
e],g;for(g in a)if(a.hasOwnProperty(g)){var h=a[g];h&&(h.get||h.set)?(h.get&&f.push("Public "+("_"===g?"Default ":"")+"Property Get ["+g+"]","Call VBCVal([(accessors)].["+g+"].get.call(me),["+g+"])","End Property"),h.set&&f.push("Public Property Let ["+g+"](val)",h="Call [(accessors)].["+g+"].set.call(me,val)\nEnd Property","Public Property Set ["+g+"](val)",h)):(b.push(g),f.push("Public ["+g+"]"))}f.push("Private [(accessors)]","Private Sub Class_Initialize()","Set [(accessors)]="+e+"FactoryJS()",
"End Sub","End Class","Function "+e+"Factory()","Set "+e+"Factory=New "+e,"End Function");d.execScript(f.join("\n"),"VBScript");d[e+"FactoryJS"]=function(){return a};e=d[e+"Factory"]();for(f=0;f<b.length;f++)e[b[f]]=a[b[f]];return e}function b(a){var b=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return b.test(a)?'"'+a.replace(b,
function(a){return a in c?c[a]:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}var c=d.eval&&eval("/*@cc_on 1;@*/");if(c&&!(g.documentMode&&7<g.documentMode)){var e=x,i=h().a,o=g.createElement("iframe");o.src="javascript:true;";o=H.firstChild.appendChild(o).contentWindow;d.execScript("Public history\nFunction VBCVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript");t={_:{get:J.toString}};k={back:n.back,forward:n.forward,go:n.go,emulate:l,_:{get:function(){return"[object History]"}}};
r={parse:function(a){try{return(new Function("","return "+a))()}catch(b){return l}},stringify:function(a){var c=(typeof a).charCodeAt(2);if(114===c)a=b(a);else if(109===c)a=isFinite(a)?""+a:"null";else if(111===c||108===c)a=""+a;else if(106===c)if(a){var d=(c="[object Array]"===E.prototype.toString.call(a))?"[":"{";if(c)for(var e=0;e<a.length;e++)d+=(0==e?"":",")+r.stringify(a[e]);else for(e in a)a.hasOwnProperty(e)&&(d+=(1==d.length?"":",")+b(e)+":"+r.stringify(a[e]));a=d+(c?"]":"}")}else a="null";
else a="void 0";return a}};s=function(a,b,c,d,e){var g=o.document,b=h(b);C=m;if(b.c===h().c&&!e)a&&(p[f.href]=a);else{z=d;if(c)o.lfirst?(history.back(),s(a,b.a,0,d,1)):f.replace("#"+b.d);else if(b.a!=i||e)o.lfirst?e&&(e=0,a=p[f.href]):(o.lfirst=1,s(a,i,0,d,1)),g.open(),g.write('<script>lfirst=1;parent.location.hash="'+b.d.replace(/"/g,'\\"')+'";<\/script>'),g.close();!e&&a&&(p[f.href]=a)}};x=function(b,c,f,g){e.apply(this,arguments)||(b===t?t[c]=f:b===k?(k[c]=f,"state"===c&&(t=a(t),d.history=k=a(k),
d.execScript("var history = window.history;","JavaScript"))):b[c]=f.get&&f.get());return b};setInterval(function(){var a=h().a;if(a!=i){var b=g.createEventObject();b.oldURL=i;b.newURL=i=a;b.type="hashchange";K(b)}},100);d.JSON=r}}var d=("object"===typeof window?window:this)||{};if(!d.history||"emulate"in d.history)return d.history;var g=d.document,H=g.documentElement,E=d.Object,r=d.JSON,f=d.location,n=d.history,k=n,L=n.pushState,V=n.replaceState,q=!!L,G="state"in n,B=E.defineProperty,t=x({},"t")?
{}:g.createElement("a"),w="",M=d.addEventListener?"addEventListener":(w="on")&&"attachEvent",W=d.removeEventListener?"removeEventListener":"detachEvent",X=d.dispatchEvent?"dispatchEvent":"fireEvent",v=d[M],Q=d[W],da=d[X],i={basepath:"/",redirect:0,type:"/"},D="__historyAPI__",P=g.createElement("a"),z=f.href,S="",C=m,p={},y={},A=g.title,ga={onhashchange:l,onpopstate:l},Y={setup:function(a,b,c){i.basepath=(""+(a==l?i.basepath:a)).replace(/(?:^|\/)[^\/]*$/,"/");i.type=b==l?i.type:b;i.redirect=c==l?i.redirect:
!!c},redirect:function(a,b){k.setup(b,a);b=i.basepath;if(d.top==d.self){var c=h(l,m,j).c,e=f.pathname+f.search;q?(e=e.replace(/([^\/])$/,"$1/"),c!=b&&RegExp("^"+b+"$","i").test(e)&&f.replace(c)):e!=b&&(e=e.replace(/([^\/])\?/,"$1/?"),RegExp("^"+b,"i").test(e)&&f.replace(b+"#"+e.replace(RegExp("^"+b,"i"),i.type)+f.hash))}},pushState:function(a,b,c){var d=g.title;A!=l&&(g.title=A);L&&O(L,arguments);s(a,c);g.title=d;A=b},replaceState:function(a,b,c){var d=g.title;A!=l&&(g.title=A);delete p[f.href];V&&
O(V,arguments);s(a,c,j);g.title=d;A=b},location:{set:function(a){d.location=a},get:function(){return q?f:t}},state:{get:function(){return p[f.href]||l}}},J={assign:function(a){0===(""+a).indexOf("#")?s(l,a):f.assign(a)},reload:function(){f.reload()},replace:function(a){0===(""+a).indexOf("#")?s(l,a,j):f.replace(a)},toString:function(){return this.href},href:{get:function(){return h().a}},protocol:l,host:l,hostname:l,port:l,pathname:{get:function(){return h().e}},search:{get:function(){return h().f}},
hash:{set:function(a){s(l,(""+a).replace(/^(#|)/,"#"),m,z)},get:function(){return h().b}}};if(function(){var a=g.getElementsByTagName("script"),a=(a[a.length-1]||{}).src||"";(-1!==a.indexOf("?")?a.split("?").pop():"").replace(/(\w+)(?:=([^&]*))?/g,function(a,b,c){i[b]=(c||"").replace(/^(0|false)$/,"")});fa();v(w+"hashchange",K,m);var b=[J,t,ga,d,Y,k];G&&delete Y.state;for(var c=0;c<b.length;c+=2)for(var e in b[c])if(b[c].hasOwnProperty(e))if("function"===typeof b[c][e])b[c+1][e]=b[c][e];else{a=aa(b[c],
e,b[c][e]);if(!x(b[c+1],e,a,function(a,e){if(e===k)d.history=k=b[c+1]=a}))return Q(w+"hashchange",K,m),m;b[c+1]===d&&(y[e]=y[e.substr(2)]=[])}k.setup();i.redirect&&k.redirect();!G&&r&&Z();if(!q)g[M](w+"click",ea,m);"complete"===g.readyState?T(j):(!q&&h().c!==i.basepath&&(C=j),v(w+"load",T,m));return j}())return k.emulate=!q,d[M]=ba,d[W]=ca,d[X]=F,k});